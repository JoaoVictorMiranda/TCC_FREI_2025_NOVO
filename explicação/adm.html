<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema de Autenticação - Tutorial Completo</title>
    <style>
        :root {
            --primary: #2c3e50;
            --secondary: #3498db;
            --accent: #e74c3c;
            --light: #ecf0f1;
            --dark: #34495e;
            --success: #2ecc71;
            --warning: #f39c12;
            --danger: #e74c3c;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f5f7fa;
            color: #333;
            line-height: 1.6;
        }
        
        header {
            background: linear-gradient(135deg, var(--primary), var(--dark));
            color: white;
            padding: 2rem 0;
            text-align: center;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }
        
        h1 {
            font-size: 2.5rem;
            margin-bottom: 1rem;
        }
        
        .subtitle {
            font-size: 1.2rem;
            opacity: 0.9;
            max-width: 800px;
            margin: 0 auto;
        }
        
        nav {
            background-color: white;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            position: sticky;
            top: 0;
            z-index: 100;
        }
        
        .nav-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem 0;
        }
        
        .logo {
            font-weight: bold;
            font-size: 1.5rem;
            color: var(--primary);
        }
        
        .nav-links {
            display: flex;
            list-style: none;
        }
        
        .nav-links li {
            margin-left: 2rem;
        }
        
        .nav-links a {
            text-decoration: none;
            color: var(--dark);
            font-weight: 500;
            transition: color 0.3s;
        }
        
        .nav-links a:hover {
            color: var(--secondary);
        }
        
        main {
            padding: 3rem 0;
        }
        
        .section {
            background-color: white;
            border-radius: 8px;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
        }
        
        .section-title {
            color: var(--primary);
            margin-bottom: 1.5rem;
            padding-bottom: 0.5rem;
            border-bottom: 2px solid var(--light);
        }
        
        .code-block {
            background-color: #2d2d2d;
            color: #f8f8f2;
            border-radius: 5px;
            padding: 1.5rem;
            margin: 1.5rem 0;
            overflow-x: auto;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            line-height: 1.5;
        }
        
        .code-comment {
            color: #75715e;
        }
        
        .code-keyword {
            color: #f92672;
        }
        
        .code-function {
            color: #66d9ef;
        }
        
        .code-string {
            color: #e6db74;
        }
        
        .code-number {
            color: #ae81ff;
        }
        
        .step {
            margin-bottom: 2rem;
        }
        
        .step-title {
            color: var(--secondary);
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
        }
        
        .step-number {
            background-color: var(--secondary);
            color: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 10px;
            font-size: 0.9rem;
        }
        
        .flow-diagram {
            background-color: var(--light);
            border-radius: 8px;
            padding: 1.5rem;
            margin: 1.5rem 0;
        }
        
        .flow-step {
            display: flex;
            align-items: center;
            margin-bottom: 1rem;
            padding: 1rem;
            background-color: white;
            border-radius: 5px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }
        
        .flow-arrow {
            text-align: center;
            margin: 0.5rem 0;
            color: var(--secondary);
            font-weight: bold;
        }
        
        .example-box {
            border-left: 4px solid var(--success);
            background-color: #f8fff8;
            padding: 1.5rem;
            margin: 1.5rem 0;
        }
        
        .example-title {
            color: var(--success);
            margin-bottom: 1rem;
            font-weight: bold;
        }
        
        .security-points {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 1.5rem;
            margin-top: 1.5rem;
        }
        
        .security-card {
            background-color: var(--light);
            border-radius: 5px;
            padding: 1.5rem;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
        }
        
        .security-card h4 {
            color: var(--primary);
            margin-bottom: 0.5rem;
        }
        
        footer {
            background-color: var(--primary);
            color: white;
            text-align: center;
            padding: 2rem 0;
            margin-top: 3rem;
        }
        
        @media (max-width: 768px) {
            .nav-container {
                flex-direction: column;
            }
            
            .nav-links {
                margin-top: 1rem;
            }
            
            .nav-links li {
                margin: 0 0.5rem;
            }
            
            .security-points {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <h1>Sistema de Autenticação</h1>
            <p class="subtitle">Tutorial completo explicando cada componente de um sistema de autenticação seguro usando JWT, bcrypt e middlewares em Node.js</p>
        </div>
    </header>
    
    <nav>
        <div class="container nav-container">
            <div class="logo">AuthTutorial</div>
            <ul class="nav-links">
                <li><a href="#estrutura">Estrutura</a></li>
                <li><a href="#configuracao">Configuração</a></li>
                <li><a href="#funcoes">Funções</a></li>
                <li><a href="#middlewares">Middlewares</a></li>
                <li><a href="#login">Login</a></li>
                <li><a href="#fluxo">Fluxo</a></li>
                <li><a href="#seguranca">Segurança</a></li>
            </ul>
        </div>
    </nav>
    
    <main class="container">
        <section class="section" id="introducao">
            <h2 class="section-title">Introdução ao Sistema de Autenticação</h2>
            <p>Este tutorial explica detalhadamente cada componente de um sistema de autenticação seguro para administradores. Vamos abordar desde a estrutura do banco de dados até a implementação de middlewares de proteção.</p>
        </section>
        
        <section class="section" id="estrutura">
            <h2 class="section-title">1. Estrutura do Banco de Dados</h2>
            <p>A tabela ADMIN armazena as informações dos administradores do sistema:</p>
            
            <div class="code-block">
                <span class="code-keyword">CREATE TABLE</span> <span class="code-function">ADMIN</span>(<br>
                &nbsp;&nbsp;&nbsp;&nbsp;id_admin <span class="code-keyword">int primary key auto_increment</span>,<br>
                &nbsp;&nbsp;&nbsp;&nbsp;nome <span class="code-keyword">varchar</span>(200),<br>
                &nbsp;&nbsp;&nbsp;&nbsp;email <span class="code-keyword">varchar</span>(200) <span class="code-keyword">UNIQUE</span>,<br>
                &nbsp;&nbsp;&nbsp;&nbsp;senha <span class="code-keyword">varchar</span>(255),<br>
                &nbsp;&nbsp;&nbsp;&nbsp;criado_em <span class="code-keyword">datetime</span>,<br>
                &nbsp;&nbsp;&nbsp;&nbsp;isAdmin <span class="code-keyword">boolean default true</span><br>
                );
            </div>
            
            <div class="step">
                <h3 class="step-title"><span class="step-number">1</span>Explicação dos Campos:</h3>
                <ul>
                    <li><strong>id_admin</strong>: Identificador único que aumenta automaticamente</li>
                    <li><strong>nome</strong>: Nome do administrador (até 200 caracteres)</li>
                    <li><strong>email</strong>: Email único (não pode repetir)</li>
                    <li><strong>senha</strong>: Senha criptografada (255 caracteres para hash)</li>
                    <li><strong>criado_em</strong>: Data e hora de criação</li>
                    <li><strong>isAdmin</strong>: Sempre true pois é tabela de administradores</li>
                </ul>
            </div>
        </section>
        
        <section class="section" id="configuracao">
            <h2 class="section-title">2. Configuração Inicial e Dependências</h2>
            <p>Primeiro, precisamos importar as bibliotecas necessárias e configurar as chaves:</p>
            
            <div class="code-block">
                <span class="code-keyword">const</span> jwt = <span class="code-function">require</span>(<span class="code-string">'jsonwebtoken'</span>);<br>
                <span class="code-keyword">const</span> bcrypt = <span class="code-function">require</span>(<span class="code-string">'bcrypt'</span>);<br>
                <span class="code-keyword">const</span> SECRET_KEY = <span class="code-string">'sua_chave_secreta'</span>;
            </div>
            
            <div class="step">
                <h3 class="step-title"><span class="step-number">2</span>Explicação:</h3>
                <ul>
                    <li><strong>jwt</strong>: Biblioteca para criar e verificar tokens JWT</li>
                    <li><strong>bcrypt</strong>: Biblioteca para criptografar senhas</li>
                    <li><strong>SECRET_KEY</strong>: Chave secreta para assinar os tokens (em produção use variáveis de ambiente)</li>
                </ul>
            </div>
        </section>
        
        <section class="section" id="funcoes">
            <h2 class="section-title">3. Funções Auxiliares</h2>
            
            <div class="step">
                <h3 class="step-title"><span class="step-number">3.1</span>Função generateToken</h3>
                <div class="code-block">
                    <span class="code-keyword">function</span> <span class="code-function">generateToken</span>(admin) {<br>
                    &nbsp;&nbsp;<span class="code-keyword">return</span> jwt.<span class="code-function">sign</span>(<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;{<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;id: admin.id_admin,<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;email: admin.email,<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;role: {<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;type: admin.isAdmin ? <span class="code-string">'administrador'</span> : <span class="code-string">'user'</span><br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;},<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;SECRET_KEY,<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;{ expiresIn: <span class="code-string">'24h'</span> }<br>
                    &nbsp;&nbsp;);<br>
                    }
                </div>
                
                <h4>Passo a passo:</h4>
                <ol>
                    <li>Recebe um objeto admin com dados do banco</li>
                    <li>jwt.sign() cria um token JWT com 3 partes:
                        <ul>
                            <li><strong>Payload</strong>: Dados que serão armazenados no token (id, email, role)</li>
                            <li><strong>Secret</strong>: Chave secreta para assinar</li>
                            <li><strong>Options</strong>: Configurações (expira em 24 horas)</li>
                        </ul>
                    </li>
                    <li>Retorna o token que será enviado para o frontend</li>
                </ol>
            </div>
            
            <div class="step">
                <h3 class="step-title"><span class="step-number">3.2</span>Função verifyPassword</h3>
                <div class="code-block">
                    <span class="code-keyword">async function</span> <span class="code-function">verifyPassword</span>(password, hashedPassword) {<br>
                    &nbsp;&nbsp;<span class="code-keyword">return await</span> bcrypt.<span class="code-function">compare</span>(password, hashedPassword);<br>
                    }
                </div>
                
                <h4>Passo a passo:</h4>
                <ol>
                    <li>Recebe a senha digitada e o hash armazenado no banco</li>
                    <li>bcrypt.compare() compara a senha com o hash</li>
                    <li>Retorna true se coincidir, false se não</li>
                </ol>
            </div>
            
            <div class="step">
                <h3 class="step-title"><span class="step-number">3.3</span>Função hashPassword</h3>
                <div class="code-block">
                    <span class="code-keyword">async function</span> <span class="code-function">hashPassword</span>(password) {<br>
                    &nbsp;&nbsp;<span class="code-keyword">return await</span> bcrypt.<span class="code-function">hash</span>(password, <span class="code-number">10</span>);<br>
                    }
                </div>
                
                <h4>Passo a passo:</h4>
                <ol>
                    <li>Recebe a senha em texto puro</li>
                    <li>bcrypt.hash() cria um hash seguro</li>
                    <li>O número 10 é o "salt rounds" (quantidade de processamento para gerar o hash)</li>
                </ol>
            </div>
        </section>
        
        <section class="section" id="middlewares">
            <h2 class="section-title">4. Middlewares de Autenticação</h2>
            
            <div class="step">
                <h3 class="step-title"><span class="step-number">4.1</span>Middleware authenticate</h3>
                <div class="code-block">
                    <span class="code-keyword">function</span> <span class="code-function">authenticate</span>(throw401 = <span class="code-keyword">true</span>) {<br>
                    &nbsp;&nbsp;<span class="code-keyword">return</span> (req, resp, next) => {<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;<span class="code-keyword">try</span> {<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="code-keyword">const</span> token = req.headers.authorization?.<span class="code-function">replace</span>(<span class="code-string">'Bearer '</span>, <span class="code-string">''</span>);<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="code-keyword">if</span> (!token && throw401) {<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="code-keyword">return</span> resp.<span class="code-function">status</span>(<span class="code-number">401</span>).<span class="code-function">json</span>({ error: <span class="code-string">'Token não fornecido'</span> });<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
                    <br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="code-keyword">if</span> (token) {<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="code-keyword">const</span> decoded = jwt.<span class="code-function">verify</span>(token, SECRET_KEY);<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;req.user = decoded;<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
                    <br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="code-function">next</span>();<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;} <span class="code-keyword">catch</span> (error) {<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="code-keyword">if</span> (throw401) {<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="code-keyword">return</span> resp.<span class="code-function">status</span>(<span class="code-number">401</span>).<span class="code-function">json</span>({ error: <span class="code-string">'Token inválido ou expirado'</span> });<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="code-function">next</span>();<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;}<br>
                    &nbsp;&nbsp;};<br>
                    }
                </div>
                
                <h4>Passo a passo:</h4>
                <ol>
                    <li><strong>Entrada</strong>: Recebe a requisição (req), resposta (resp) e next</li>
                    <li><strong>Extrai token</strong>: Pega o token do header Authorization</li>
                    <li><strong>Remove "Bearer "</strong>: Limpa o prefixo do token</li>
                    <li><strong>Verifica existência</strong>: Se não tem token e throw401 é true, retorna erro 401</li>
                    <li><strong>Decodifica token</strong>: Usa jwt.verify() para validar e decodificar o token</li>
                    <li><strong>Adiciona usuário à requisição</strong>: Salva os dados decodificados em req.user</li>
                    <li><strong>Next()</strong>: Passa para o próximo middleware/rota</li>
                    <li><strong>Tratamento de erro</strong>: Se token inválido, retorna erro 401</li>
                </ol>
            </div>
            
            <div class="step">
                <h3 class="step-title"><span class="step-number">4.2</span>Middleware requireAdmin</h3>
                <div class="code-block">
                    <span class="code-keyword">function</span> <span class="code-function">requireAdmin</span>(req, resp, next) {<br>
                    &nbsp;&nbsp;<span class="code-keyword">const</span> checkRole = (user) => user.role.type === <span class="code-string">'administrador'</span>;<br>
                    &nbsp;&nbsp;<br>
                    &nbsp;&nbsp;<span class="code-keyword">if</span> (!req.user) {<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;<span class="code-keyword">return</span> resp.<span class="code-function">status</span>(<span class="code-number">401</span>).<span class="code-function">json</span>({ error: <span class="code-string">'Não autenticado'</span> });<br>
                    &nbsp;&nbsp;}<br>
                    <br>
                    &nbsp;&nbsp;<span class="code-keyword">if</span> (!<span class="code-function">checkRole</span>(req.user) && req.user.role.type !== <span class="code-string">'administrador'</span>) {<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;<span class="code-keyword">return</span> resp.<span class="code-function">status</span>(<span class="code-number">403</span>).<span class="code-function">json</span>({ error: <span class="code-string">'Acesso negado. Permissão de administrador necessária.'</span> });<br>
                    &nbsp;&nbsp;}<br>
                    <br>
                    &nbsp;&nbsp;<span class="code-function">next</span>();<br>
                    }
                </div>
                
                <h4>Passo a passo:</h4>
                <ol>
                    <li><strong>Verifica autenticação</strong>: Se req.user não existe, retorna erro 401</li>
                    <li><strong>Verifica permissão</strong>: Usa a função checkRole para verificar se é administrador</li>
                    <li><strong>Comparação direta</strong>: Também verifica diretamente o tipo de role</li>
                    <li><strong>Acesso negado</strong>: Se não for administrador, retorna erro 403</li>
                    <li><strong>Next()</strong>: Se tudo ok, passa para a próxima função</li>
                </ol>
            </div>
        </section>
        
        <section class="section" id="login">
            <h2 class="section-title">5. Rota de Login</h2>
            
            <div class="step">
                <h3 class="step-title"><span class="step-number">5.1</span>Estrutura da Rota</h3>
                <div class="code-block">
                    router.<span class="code-function">post</span>(<span class="code-string">'/admin/login'</span>, <span class="code-keyword">async</span> (req, res) => {<br>
                    &nbsp;&nbsp;<span class="code-comment">// Implementação...</span><br>
                    });
                </div>
                
                <h4>Fluxo completo do login:</h4>
                
                <div class="flow-diagram">
                    <div class="flow-step">
                        <strong>Passo 1:</strong> Validação de entrada
                    </div>
                    <div class="code-block">
                        <span class="code-keyword">const</span> { email, senha } = req.body;<br>
                        <br>
                        <span class="code-keyword">if</span> (!email || !senha) {<br>
                        &nbsp;&nbsp;<span class="code-keyword">return</span> res.<span class="code-function">status</span>(<span class="code-number">400</span>).<span class="code-function">json</span>({ error: <span class="code-string">'Email e senha são obrigatórios'</span> });<br>
                        }
                    </div>
                    <p>Extrai email e senha do corpo da requisição e verifica se ambos foram fornecidos.</p>
                    
                    <div class="flow-arrow">↓</div>
                    
                    <div class="flow-step">
                        <strong>Passo 2:</strong> Busca no banco de dados
                    </div>
                    <div class="code-block">
                        <span class="code-keyword">const</span> [admins] = <span class="code-keyword">await</span> db.<span class="code-function">execute</span>(<br>
                        &nbsp;&nbsp;<span class="code-string">'SELECT * FROM ADMIN WHERE email = ? AND isAdmin = true'</span>,<br>
                        &nbsp;&nbsp;[email]<br>
                        );<br>
                        <br>
                        <span class="code-keyword">if</span> (admins.length === <span class="code-number">0</span>) {<br>
                        &nbsp;&nbsp;<span class="code-keyword">return</span> res.<span class="code-function">status</span>(<span class="code-number">401</span>).<span class="code-function">json</span>({ error: <span class="code-string">'Credenciais inválidas'</span> });<br>
                        }
                    </div>
                    <p>Executa query SQL para buscar administrador pelo email e verifica se encontrou algum resultado.</p>
                    
                    <div class="flow-arrow">↓</div>
                    
                    <div class="flow-step">
                        <strong>Passo 3:</strong> Verificação de senha
                    </div>
                    <div class="code-block">
                        <span class="code-keyword">const</span> admin = admins[<span class="code-number">0</span>];<br>
                        <span class="code-keyword">const</span> isPasswordValid = <span class="code-keyword">await</span> <span class="code-function">verifyPassword</span>(senha, admin.senha);<br>
                        <br>
                        <span class="code-keyword">if</span> (!isPasswordValid) {<br>
                        &nbsp;&nbsp;<span class="code-keyword">return</span> res.<span class="code-function">status</span>(<span class="code-number">401</span>).<span class="code-function">json</span>({ error: <span class="code-string">'Credenciais inválidas'</span> });<br>
                        }
                    </div>
                    <p>Pega o primeiro resultado (deveria ser único devido ao UNIQUE) e compara a senha digitada com o hash do banco.</p>
                    
                    <div class="flow-arrow">↓</div>
                    
                    <div class="flow-step">
                        <strong>Passo 4:</strong> Geração do token
                    </div>
                    <div class="code-block">
                        <span class="code-keyword">const</span> token = <span class="code-function">generateToken</span>(admin);
                    </div>
                    <p>Gera um token JWT com os dados do administrador.</p>
                    
                    <div class="flow-arrow">↓</div>
                    
                    <div class="flow-step">
                        <strong>Passo 5:</strong> Resposta de sucesso
                    </div>
                    <div class="code-block">
                        res.<span class="code-function">json</span>({<br>
                        &nbsp;&nbsp;message: <span class="code-string">'Login realizado com sucesso'</span>,<br>
                        &nbsp;&nbsp;token,<br>
                        &nbsp;&nbsp;admin: {<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;id: admin.id_admin,<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;nome: admin.nome,<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;email: admin.email,<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;isAdmin: admin.isAdmin<br>
                        &nbsp;&nbsp;}<br>
                        });
                    </div>
                    <p>Retorna token e informações do administrador (sem a senha).</p>
                </div>
            </div>
        </section>
        
        <section class="section" id="fluxo">
            <h2 class="section-title">6. Como o Sistema Funciona em Conjunto</h2>
            
            <h3>Fluxo Completo de uma Requisição Protegida:</h3>
            <p>Exemplo: Acessar /admin/dashboard</p>
            
            <div class="flow-diagram">
                <div class="flow-step">
                    <strong>1. Frontend envia requisição:</strong>
                </div>
                <div class="code-block">
                    <span class="code-comment">// Headers da requisição</span><br>
                    Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
                </div>
                
                <div class="flow-arrow">↓</div>
                
                <div class="flow-step">
                    <strong>2. Middleware authenticate executa:</strong>
                </div>
                <ul>
                    <li>Extrai o token do header</li>
                    <li>Verifica se é válido usando a SECRET_KEY</li>
                    <li>Decodifica e adiciona req.user com os dados</li>
                </ul>
                
                <div class="flow-arrow">↓</div>
                
                <div class="flow-step">
                    <strong>3. Middleware requireAdmin executa:</strong>
                </div>
                <ul>
                    <li>Verifica se req.user existe</li>
                    <li>Confirma que req.user.role.type === 'administrador'</li>
                </ul>
                
                <div class="flow-arrow">↓</div>
                
                <div class="flow-step">
                    <strong>4. Se tudo ok:</strong>
                </div>
                <ul>
                    <li>Executa a rota /admin/dashboard</li>
                    <li>Retorna os dados solicitados</li>
                </ul>
                
                <div class="flow-arrow">↓</div>
                
                <div class="flow-step">
                    <strong>5. Se houver erro:</strong>
                </div>
                <ul>
                    <li>Retorna 401 (não autenticado) ou 403 (sem permissão)</li>
                </ul>
            </div>
            
            <div class="example-box">
                <h3 class="example-title">Exemplos de Uso Prático</h3>
                
                <h4>7.1 Fazendo login</h4>
                <div class="code-block">
                    <span class="code-comment"># Request</span><br>
                    POST /api/admin/login<br>
                    Content-Type: application/json<br>
                    <br>
                    {<br>
                    &nbsp;&nbsp;"email": "admin@exemplo.com",<br>
                    &nbsp;&nbsp;"senha": "123456"<br>
                    }<br>
                    <br>
                    <span class="code-comment"># Response</span><br>
                    {<br>
                    &nbsp;&nbsp;"message": "Login realizado com sucesso",<br>
                    &nbsp;&nbsp;"token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",<br>
                    &nbsp;&nbsp;"admin": {<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;"id": 1,<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;"nome": "João Silva",<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;"email": "admin@exemplo.com",<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;"isAdmin": true<br>
                    &nbsp;&nbsp;}<br>
                    }
                </div>
                
                <h4>7.2 Acessando rota protegida</h4>
                <div class="code-block">
                    <span class="code-comment"># Request</span><br>
                    GET /api/admin/dashboard<br>
                    Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...<br>
                    <br>
                    <span class="code-comment"># Response</span><br>
                    {<br>
                    &nbsp;&nbsp;"message": "Bem-vindo ao painel administrativo",<br>
                    &nbsp;&nbsp;"user": {<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;"id": 1,<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;"email": "admin@exemplo.com",<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;"role": {<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"type": "administrador"<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;}<br>
                    &nbsp;&nbsp;}<br>
                    }
                </div>
                
                <h4>7.3 Tentativa de acesso sem permissão</h4>
                <div class="code-block">
                    <span class="code-comment"># Request com token de usuário comum</span><br>
                    GET /api/admin/dashboard<br>
                    Authorization: Bearer token_de_usuario_comum<br>
                    <br>
                    <span class="code-comment"># Response</span><br>
                    {<br>
                    &nbsp;&nbsp;"error": "Acesso negado. Permissão de administrador necessária."<br>
                    }
                </div>
            </div>
        </section>
        
        <section class="section" id="seguranca">
            <h2 class="section-title">8. Segurança Implementada</h2>
            <p>Este sistema implementa várias camadas de segurança para proteger os dados e o acesso:</p>
            
            <div class="security-points">
                <div class="security-card">
                    <h4>Senhas Hasheadas</h4>
                    <p>Nunca armazenadas em texto puro, sempre criptografadas com bcrypt</p>
                </div>
                
                <div class="security-card">
                    <h4>Tokens JWT</h4>
                    <p>Stateless authentication com assinatura digital</p>
                </div>
                
                <div class="security-card">
                    <h4>Expiração</h4>
                    <p>Tokens expiram em 24h, reduzindo riscos de tokens vazados</p>
                </div>
                
                <div class="security-card">
                    <h4>Verificação de Role</h4>
                    <p>Dupla verificação de permissões para acesso administrativo</p>
                </div>
                
                <div class="security-card">
                    <h4>Tratamento de Erros</h4>
                    <p>Mensagens genéric